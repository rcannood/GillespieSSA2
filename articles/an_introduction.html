<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GillespieSSA2">
<title>Introduction to GillespieSSA2 â€¢ GillespieSSA2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to GillespieSSA2">
<meta property="og:description" content="GillespieSSA2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GillespieSSA2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/an_introduction.html">Introduction to GillespieSSA2</a>
    <a class="dropdown-item" href="../articles/converting_from_GillespieSSA.html">Converting from GillespieSSA to GillespieSSA2</a>
    <a class="dropdown-item" href="../articles/decaying_dimer.html">Decaying-Dimerization Reaction Set</a>
    <a class="dropdown-item" href="../articles/epi_chain.html">SIRS metapopulation model</a>
    <a class="dropdown-item" href="../articles/linear_chain.html">Linear Chain System</a>
    <a class="dropdown-item" href="../articles/logistic_growth.html">Pearl-Verhulst Logistic Growth model</a>
    <a class="dropdown-item" href="../articles/lotka_predator_prey.html">Lotka Predator-Prey model</a>
    <a class="dropdown-item" href="../articles/radioactive_decay.html">Radioactive Decay model</a>
    <a class="dropdown-item" href="../articles/rm_predator_prey.html">Rosenzweig-MacArthur Predator-Prey model</a>
    <a class="dropdown-item" href="../articles/sir.html">Kermack-McKendrick SIR model</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rcannood/GillespieSSA2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to GillespieSSA2</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rcannood/GillespieSSA2/blob/HEAD/vignettes/an_introduction.Rmd" class="external-link"><code>vignettes/an_introduction.Rmd</code></a></small>
      <div class="d-none name"><code>an_introduction.Rmd</code></div>
    </div>

    
    
<!-- github markdown built using 
rmarkdown::render("vignettes/an_introduction.Rmd", output_format = "github_document")
-->
<p>In order to invoke <code><a href="../reference/ssa.html">ssa()</a></code>, the stochastic model needs at
least three components:</p>
<ul>
<li>the initial state vector (<code>initial_state</code>),</li>
<li>the reactions (<code>reactions</code>),</li>
<li>the final time of the simulation (<code>final_time</code>).</li>
</ul>
<p>The initial state vector defines the population sizes in all the
states at <span class="math inline">\(t = 0\)</span>. For example, for a
system with two species <code>prey</code> and <code>predators</code>
where both have an initial population size of 1000, the initial state
vector is defined as follows.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rcannood.github.io/GillespieSSA2/">GillespieSSA2</a></span><span class="op">)</span></span>
<span><span class="va">initial_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>prey <span class="op">=</span> <span class="fl">1000</span>, predators <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The reactions define the change in the number of individuals that can
occur at any given timepoint during the simulation. During an
infinitesimal period of time, the reaction can occur with a probability
defined by its propensity function. For example, a system with
abovementioned species could have three reactions; one in which the prey
population grows, one in which the predator population grows by feasting
on the prey, and one in which the predator population diminishes. The
matrix could then be defined as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>c1 <span class="op">=</span> <span class="fl">10</span>, c2 <span class="op">=</span> <span class="fl">0.01</span>, c3 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">reactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co">#        propensity function        effects                          name for reaction</span></span>
<span>  <span class="fu"><a href="../reference/reaction.html">reaction</a></span><span class="op">(</span><span class="op">~</span><span class="va">c1</span> <span class="op">*</span> <span class="va">prey</span>,                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>prey <span class="op">=</span> <span class="op">+</span><span class="fl">1</span><span class="op">)</span>,                    name <span class="op">=</span> <span class="st">"prey_up"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/reaction.html">reaction</a></span><span class="op">(</span><span class="op">~</span><span class="va">c2</span> <span class="op">*</span> <span class="va">prey</span> <span class="op">*</span> <span class="va">predators</span>,    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>prey <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, predators <span class="op">=</span> <span class="op">+</span><span class="fl">1</span><span class="op">)</span>,    name <span class="op">=</span> <span class="st">"predation"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/reaction.html">reaction</a></span><span class="op">(</span><span class="op">~</span><span class="va">c3</span> <span class="op">*</span> <span class="va">predators</span>,           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>predators <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,               name <span class="op">=</span> <span class="st">"pred_down"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The simulation can be started by calling the <code><a href="../reference/ssa.html">ssa()</a></code>
function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/ssa.html">ssa</a></span><span class="op">(</span></span>
<span>    initial_state <span class="op">=</span> <span class="va">initial_state</span>,</span>
<span>    reactions <span class="op">=</span> <span class="va">reactions</span>,</span>
<span>    params <span class="op">=</span> <span class="va">params</span>,</span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/ssa_exact.html">ssa_exact</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    final_time <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    census_interval <span class="op">=</span> <span class="fl">.001</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sim_name <span class="op">=</span> <span class="st">"My first SSA run!"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Running SSA exact with console output every 1 seconds</span></span>
<span><span class="co">## walltime: 0, sim_time: 0</span></span>
<span><span class="co">## SSA finished!</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">stats</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   method          sim_name sim_time_exceeded all_zero_state negative_state</span></span>
<span><span class="co">## 1  exact My first SSA run!              TRUE          FALSE          FALSE</span></span>
<span><span class="co">##   all_zero_propensity negative_propensity walltime_exceeded walltime_elapsed</span></span>
<span><span class="co">## 1               FALSE               FALSE             FALSE        0.4793599</span></span>
<span><span class="co">##   num_steps   dtime_mean     dtime_sd firings_mean firings_sd</span></span>
<span><span class="co">## 1    151518 3.299954e-05 1.538995e-07            1          0</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_ssa.html">plot_ssa</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required namespace: ggplot2</span></span></code></pre>
<p><img src="an_introduction_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Robrecht Cannoodt, Wouter Saelens.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
